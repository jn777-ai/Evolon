<th:block xmlns:th="http://www.thymeleaf.org"
          xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
          th:replace="~{layout/layout :: layout(
            title='Evolon-お気に入り',
            content=~{::content},
            showHeader=true,
            showFooter=true
          )}">

  <th:block th:fragment="content">

    <div class="myp-selling">

      <a th:href="@{/my-page}" class="myp-back">← マイページへ戻る</a>

      <!-- 上の説明カード（myp-heroで統一） -->
      <section class="panel myp-hero">
        <div class="myp-hero__left">
          <h1 class="myp-hero__title">お気に入り</h1>
          <p class="myp-hero__desc">あなたがお気に入り登録した商品の一覧です。</p>
        </div>

        <a th:href="@{/items}" class="button button--primary myp-hero__cta">
          商品一覧へ
        </a>
      </section>

      <!-- 一覧（カードグリッド） -->
      <section class="panel myp-table">

        <div class="panel-head">
          <h2 class="panel-title">お気に入り商品</h2>
          <span class="chip"
                th:text="${favoriteItems != null ? #lists.size(favoriteItems) : 0} + '件'">0件</span>
        </div>

        <div class="item-grid">

          <!-- カード -->
          <article class="item-card"
                   th:each="item : ${favoriteItems}"
                   th:classappend="${item.category != null
                                    ? ' category-' + #strings.toLowerCase(item.category.name)
                                    : ' category-other'}">

            <!-- カード全体クリックで商品詳細へ -->
            <a class="item-link" th:href="@{/items/{id}(id=${item.id})}">

              <div class="item-media">
                <img th:src="${item.imageUrl != null ? item.imageUrl : '/images/placeholder.png'}"
                     alt="商品画像">
              </div>

              <!-- 左上：カテゴリ -->
              <span class="type-badge"
                    th:text="${item.category != null ? item.category.name : 'その他'}">カテゴリ</span>

              <!-- 右上：ステータス -->
              <span class="status-badge"
                    th:classappend="${item.status != null and item.status.name() == 'SOLD'} ? ' sold' : ' selling'"
                    th:text="${item.status != null ? item.status.label : '—'}">ステータス</span>

              <div class="item-body">
                <h3 class="item-title" th:text="${item.name}">商品名</h3>

                <div class="item-bottom">
                  <p class="price"
                     th:text="'¥' + ${#numbers.formatDecimal(item.price, 0,'COMMA', 0, 'POINT')}">¥0</p>
                </div>
              </div>

            </a>
          </article>

          <!-- 空状態 -->
          <div class="empty-state" th:if="${favoriteItems == null or #lists.isEmpty(favoriteItems)}">
            お気に入りの商品はありません。
          </div>

        </div>

      </section>

    </div>

  </th:block>
</th:block>
